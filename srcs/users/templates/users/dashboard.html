<!-- templates/users/dashboard.html -->
{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}

<script>
    const wsProtocol = window.location.protocol === "https:" ? "wss://" : "ws://";
    const wsUrl = wsProtocol + window.location.host + "/ws/online_status/";
    const socket = new WebSocket(wsUrl);

    socket.onopen = function (event) {
        console.log("WebSocket is connected.");
    };

    socket.onclose = function (event) {
        console.log("WebSocket is closed.");
    };

    socket.onmessage = function (event) {
        const data = JSON.parse(event.data);
        console.log("Message from server ", data);
    };

    socket.onerror = function (error) {
        console.error("WebSocket error: ", error);
    };
</script>

  {% csrf_token %}
  <center>
	<h2>Bem-vindo {{ user.username }}!</h2>
	<br><br>
</center>
  <div class="row">
	<div class="column" style="background-color:#ccc;">
		<div class="mt-3">
			<p>&emsp;&emsp;<b>Avatar : </b> <img src="{{ user.avatar.url }}" alt="User Avatar" class="img-thumbnail" width="150" height="150"></p>
		</div>
		<p>&emsp;&emsp;<b>ID : </b> {{ user.id }}</p>
		<p>&emsp;&emsp;<b>Email : </b> {{ user.email }}</p>
		<p>&emsp;&emsp;<b>Nome : </b> {{ user.first_name }} {{ user.last_name }}</p>
		<p>&emsp;&emsp;<b>Username : </b> {{ user.username }}</p>
		<p>&emsp;&emsp;<b>Nickname : </b> {{ user.nickname }}</p>
		<p>&emsp;&emsp;<b>Registro em: </b> {{ user.date_joined }}</p>
		<p>&emsp;&emsp;<b>Último login em : </b> {{ user.last_login }}</p>
		<p>&emsp;&emsp;<b>Activo : </b> {{ user.is_active }}</p>
		<p>&emsp;&emsp;<b>Superusuário: </b> {{ user.is_superuser }}</p>
		<p>&emsp;&emsp;<b>Staff : </b> {{ user.is_staff }}</p>
		<center>
			<p><a href="{% url 'users:update_profile' %}">Update Profile</a></p>
		</center>
	</div>
	<div class="column" style="background-color:#eee;">
		{% include "users/friends_list.html" with friends=friends %}
	</div>
  </div>
  <center>
	<br><br>
    <form method="post" action="{% url 'auth:logout' %}">
      {% csrf_token %}
      <button type="submit" class="btn btn-danger">Logout</button>
    </form>
  </center>
{% endblock %}
